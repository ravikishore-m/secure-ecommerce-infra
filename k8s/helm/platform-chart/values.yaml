global:
  imageRegistry: "<account>.dkr.ecr.<region>.amazonaws.com"
  environment: nonprod
  domain: app.nonprod.demo.ecommerce-example.com
  tlsSecretName: ingress-cert

defaultResources:
  requests:
    cpu: 200m
    memory: 256Mi
  limits:
    cpu: 500m
    memory: 512Mi

rollingUpdate:
  maxUnavailable: 1
  maxSurge: 1

statefulset:
  podManagementPolicy: OrderedReady
  rollingUpdate:
    partition: 0
  persistence:
    accessModes:
      - ReadWriteOnce
    size: 10Gi
    storageClass: ""
    volumeMode: Filesystem

database:
  host: "ecommerce-db.nonprod.example"
  port: "5432"
  name: "ecommerce"
  user: "appadmin"
  password: "ChangeMe123!"
  createSecret: true
  secretName: ecommerce-db

cognito:
  region: us-east-1
  userPoolId: ""
  clientId: ""

services:
  frontend:
    replicaCount: 2
    workload: deployment
    image:
      repository: frontend
      tag: v1.0.0
    containerPort: 80
    resources:
      requests:
        cpu: 150m
        memory: 256Mi
      limits:
        cpu: 400m
        memory: 512Mi
    pdb:
      minAvailable: 1
  login:
    replicaCount: 2
    workload: deployment
    image:
      repository: login
      tag: v1.0.0
    containerPort: 3000
    resources:
      requests:
        cpu: 200m
        memory: 384Mi
      limits:
        cpu: 500m
        memory: 640Mi
    pdb:
      minAvailable: 1
  orders:
    replicaCount: 2
    workload: statefulset
    image:
      repository: orders
      tag: v1.0.0
    containerPort: 3000
    resources:
      requests:
        cpu: 350m
        memory: 512Mi
      limits:
        cpu: 800m
        memory: 1Gi
    persistence:
      enabled: true
      size: 15Gi
      accessModes:
        - ReadWriteOnce
    pdb:
      maxUnavailable: 1
  payments:
    replicaCount: 2
    workload: deployment
    image:
      repository: payments
      tag: v1.0.0
    containerPort: 3000
    resources:
      requests:
        cpu: 250m
        memory: 384Mi
      limits:
        cpu: 600m
        memory: 768Mi
    pdb:
      maxUnavailable: 1
  inventory:
    replicaCount: 2
    workload: deployment
    image:
      repository: inventory
      tag: v1.0.0
    containerPort: 3000
    resources:
      requests:
        cpu: 250m
        memory: 384Mi
      limits:
        cpu: 600m
        memory: 768Mi
    pdb:
      minAvailable: 1
  catalog:
    replicaCount: 2
    workload: deployment
    image:
      repository: catalog
      tag: v1.0.0
    containerPort: 3000
    resources:
      requests:
        cpu: 200m
        memory: 256Mi
      limits:
        cpu: 500m
        memory: 512Mi
    pdb:
      minAvailable: 1

autoscaling:
  enabled: true
  minReplicas: 2
  maxReplicas: 5
  targetCPU: 60
  throttling:
    enabled: true
    metricName: http_requests_throttled_per_second
    targetAverageValue: "5"

imagePullSecrets: []
podAnnotations: {}
podLabels: {}

serviceAccount:
  create: true
  name: ""
  annotations: {}

podSecurityContext:
  runAsNonRoot: true
  runAsUser: 1000
  fsGroup: 1000

securityContext:
  allowPrivilegeEscalation: false
  readOnlyRootFilesystem: true
  capabilities:
    drop:
      - ALL
  seccompProfile:
    type: RuntimeDefault

networkPolicy:
  enabled: true
  allowedNamespaces:
    - observability
    - monitoring
    - istio-system
  ingressCidrs:
    - 10.0.0.0/8
  serviceGraph:
    frontend: []
    login: []
    orders:
      - login
    payments:
      - orders
    inventory:
      - orders
    catalog:
      - login

monitoring:
  enabled: true
  scrapeInterval: 30s

ingressBindings:
  enabled: false
  targetGroups:
    frontend: ""
    login: ""
    orders: ""
    payments: ""
    inventory: ""
    catalog: ""

pdb:
  enabled: true
  defaultMinAvailable: 1
  defaultMaxUnavailable: null

